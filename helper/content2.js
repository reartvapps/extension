async function get_image(t){let e=t,n=!0;for(let t=0;t<=6;t++)e[t]||(n=!1);if(n){const t=document.createElement("div");t.id="stealth-loading",t.textContent="Loading...",document.body.appendChild(t);let n=e[6],o=new Image;o.src=n,o.onload=function(){let t=document.createElement("canvas"),n=e[4],o=e[5];t.width=n,t.height=o,t.style.width=n,t.style.height=o,t.getContext("2d").drawImage(this,0,0,this.width,this.height,0,0,n,o);let a=new Image;a.src=t.toDataURL(),a.onload=function(){let t=document.createElement("canvas");t.setAttribute("id","visible_screen"),t.height=e[3],t.width=e[2],t.style.height=e[3],t.style.width=e[2],t.getContext("2d").drawImage(this,e[0],e[1],e[2],e[3],0,0,e[2],e[3]),chrome.runtime.sendMessage({message:"cropped_dataUrl_sent",payload:t.toDataURL(),type:"stealth"})}}}else alert("Select a valid region to perform text extraction.")}async function get_coords(){var t,e;t=window.scrollX,e=window.scrollY,window.onscroll=function(){window.scrollTo(t,e)},chrome.runtime.sendMessage({message:"capture"},(t=>{if("captured_successfully"===t.message){let i=document.createElement("canvas");i.id="canvas_background",i.style.width=window.innerWidth,i.style.height=window.innerHeight,i.width=window.innerWidth,i.height=window.innerHeight,i.style.position="fixed",i.style.left=0,i.style.top=0,i.style.zIndex="9999999999",document.body.appendChild(i),i=document.getElementById("canvas_background");let s={},d=i.getContext("2d");function e(t){s.startX=t.pageX-document.body.scrollLeft-document.documentElement.scrollLeft-i.offsetLeft,s.startY=t.pageY-document.body.scrollTop-document.documentElement.scrollTop-i.offsetTop,drag=!0}function n(){drag=!1}function o(t){drag&&(s.w=t.pageX-document.body.scrollLeft-document.documentElement.scrollLeft-i.offsetLeft-s.startX,s.h=t.pageY-document.body.scrollTop-document.documentElement.scrollTop-i.offsetTop-s.startY,s.startX<s.startX+s.w&s.startY<s.startY+s.h&&(d.clearRect(0,0,window.innerWidth,window.innerHeight),d.fillRect(0,0,window.innerWidth,s.startY),d.fillRect(0,s.startY,s.startX,window.innerHeight-s.startY),d.fillRect(s.startX,s.startY+s.h,window.innerWidth-s.startX,window.innerHeight-s.startY-s.h),d.fillRect(s.startX+s.w,s.startY,window.innerWidth-s.startX-s.w,s.h)))}async function a(){d.clearRect(0,0,i.width,i.height),document.body.removeChild(i),window.onscroll=function(){}}d.fillStyle="rgba(0, 0, 0, .06)",d.fillRect(0,0,window.innerWidth,window.innerHeight),drag=!1,i.addEventListener("mousedown",e,!1),i.addEventListener("mouseup",n,!1),i.addEventListener("mousemove",o,!1),s.startX=parseFloat(s.startX),s.startY=parseFloat(s.startY),s.w=parseFloat(s.w),s.h=parseFloat(s.h),document.getElementById("canvas_background").addEventListener("click",(()=>{a().then((()=>{get_image([s.startX,s.startY,s.w,s.h,window.innerWidth,window.innerHeight,t.payload]).then((()=>{}))}))}))}}))}async function processManualText(t){chrome.runtime.sendMessage({message:"process_manual_text",payload:t},(t=>{t.message}))}get_coords();