async function get_image(t){let e=t,n=!0;for(i=0;i<=6;i++)e[i]||(n=!1);if(n){let t=e[6],n=new Image;n.src=t,n.onload=function(){let t=document.createElement("canvas"),n=e[4],o=e[5];t.width=n,t.height=o,t.style.width=n,t.style.height=o,t.getContext("2d").drawImage(this,0,0,this.width,this.height,0,0,n,o);let s=new Image;s.src=t.toDataURL(),s.onload=function(){let t=document.createElement("canvas");t.setAttribute("id","visible_screen"),t.height=e[3],t.width=e[2],t.style.height=e[3],t.style.width=e[2],t.getContext("2d").drawImage(this,e[0],e[1],e[2],e[3],0,0,e[2],e[3]),chrome.runtime.sendMessage({message:"cropped_dataUrl_sent",payload:t.toDataURL(),type:"open"})}}}else alert("Select a valid region to perform text extraction.")}async function get_coords(){var t,e;t=window.scrollX,e=window.scrollY,window.onscroll=function(){window.scrollTo(t,e)},chrome.runtime.sendMessage({message:"capture"},(t=>{if("captured_successfully"===t.message){let a=document.createElement("canvas");a.id="canvas_background",a.style.width=window.innerWidth,a.style.height=window.innerHeight,a.width=window.innerWidth,a.height=window.innerHeight,a.style.position="fixed",a.style.left=0,a.style.top=0,a.style.zIndex="9999999999",document.body.appendChild(a),a=document.getElementById("canvas_background");let i={},d=a.getContext("2d");function e(t){i.startX=t.pageX-document.body.scrollLeft-document.documentElement.scrollLeft-a.offsetLeft,i.startY=t.pageY-document.body.scrollTop-document.documentElement.scrollTop-a.offsetTop,drag=!0}function n(){drag=!1}function o(t){drag&&(i.w=t.pageX-document.body.scrollLeft-document.documentElement.scrollLeft-a.offsetLeft-i.startX,i.h=t.pageY-document.body.scrollTop-document.documentElement.scrollTop-a.offsetTop-i.startY,i.startX<i.startX+i.w&i.startY<i.startY+i.h&&(d.clearRect(0,0,window.innerWidth,window.innerHeight),d.fillRect(0,0,window.innerWidth,i.startY),d.fillRect(0,i.startY,i.startX,window.innerHeight-i.startY),d.fillRect(i.startX,i.startY+i.h,window.innerWidth-i.startX,window.innerHeight-i.startY-i.h),d.fillRect(i.startX+i.w,i.startY,window.innerWidth-i.startX-i.w,i.h)))}async function s(){d.clearRect(0,0,a.width,a.height),document.body.removeChild(a),window.onscroll=function(){}}chrome.storage.sync.get(["stealthMode"],(t=>{t.stealthMode||(a.style.cursor="crosshair"),d.fillStyle=`rgba(0, 0, 0, ${t.stealthMode?".06":".7"})`,d.fillRect(0,0,window.innerWidth,window.innerHeight),drag=!1})),a.addEventListener("mousedown",e,!1),a.addEventListener("mouseup",n,!1),a.addEventListener("mousemove",o,!1),i.startX=parseFloat(i.startX),i.startY=parseFloat(i.startY),i.w=parseFloat(i.w),i.h=parseFloat(i.h),document.getElementById("canvas_background").addEventListener("click",(()=>{s().then((()=>{get_image([i.startX,i.startY,i.w,i.h,window.innerWidth,window.innerHeight,t.payload]).then((()=>{}))}))}))}}))}async function processManualText(t){chrome.runtime.sendMessage({message:"process_manual_text",payload:t},(t=>{t.message}))}get_coords();